<!doctype html>
<html>
   <head>
      <meta charset="utf-8" />
      <title>Protótipo2013-1</title>
   </head>
   <body>
   <h1>Protótipo2013-1</h1>
   <canvas id ="tela" width="800" height="600">Seu navegador não suporta canvas</canvas>
   <script>
   var tela = document.getElementById ("tela");
   //console.log("Ola mundo");
   //console.log(tela);
   var ctx = tela.getContext("2d");
   //ctx.fillRect(10, 10, 50, 50);
   /*
   ctx.moveTo(10,10);
   ctx.lineTo(20,20);
   for(var i = 0; i<200; i=i+10){
      ctx.moveTo(20,20);
      ctx.lineTo(100,i);
   }
   ctx.stroke();
   */
/*
   Ax+Aw/2 < Bx-Bw/2
   Ax-Aw/2 > Bx+Bw/2
   Ay+Ah/2 < By-Bh/2
   Ay-Ah/2 > By-Bh/2

*/
   var pc = {
	   x:70, 
	   y:80,
	   h:50,
	   l:40,
	   vy:0,
	   ay:30,
	   mover:function(dt){
		this.vy+=this.ay*dt;
		this.y+=this.vy*dt;
	   }
	};
   var par1 = {
	   x:500, 
	   y:80,
	   h:50,
	   l:40,
	   vy:0,
	   ay:30,
	   mover:function(dt){
		this.vy+=this.ay*dt;
		this.y+=this.vy*dt;
	   }
	};
   var p1x = 700;
   var p1y = 200;
   function desenhaPersonagem() {
	   
	   ctx.beginPath();
	   ctx.arc(pc.x,pc.y,5,0,2*Math.PI);
	   ctx.closePath();
	   ctx.fillStyle="blue";
	   ctx.fill();
	   ctx.stroke();

	   ctx.save();
	   ctx.translate(pc.x, pc.y);
	   ctx.beginPath();
	   ctx.moveTo(0, -pc.h/3);
	   ctx.lineTo(0, pc.h/3);   
	   ctx.lineTo(pc.l/2, 2*pc.h/3);
	   ctx.moveTo(0, pc.h/3);
	   ctx.lineTo(-pc.l/2, 2*pc.h/3);
	   ctx.moveTo(0,-pc.h/15);      
	   ctx.lineTo(pc.l/2,pc.h/15);
	   ctx.moveTo(0,-pc.h/15);
	   ctx.lineTo(-pc.l/2,pc.h/15);
	   ctx.moveTo(0,-pc.h/3);
	   ctx.closePath();
	   ctx.stroke();

	   ctx.beginPath();
	   ctx.arc(0,-pc.h/3,pc.l/4,0,2*Math.PI);
	   ctx.closePath();
	   ctx.fillStyle="yellow";
	   ctx.fill();
	   ctx.stroke();
      

      ctx.beginPath();
	   ctx.strokeRect(-pc.l/2,-pc.h/2,pc.l,pc.h);
	   ctx.closePath();
	   ctx.restore();
      

	}
   
   function desenhaParede2(){
	   ctx.beginPath();
	   ctx.fillStyle="brown";	
	   ctx.fillRect(20,250,150,50);
	   ctx.strokeRect(20,250,150,50);
	   ctx.closePath();
	}
	function limpaTela(){
	   ctx.beginPath();
	   ctx.fillStyle="white";	
	   ctx.fillRect(0,0,800,600);
	   ctx.strokeRect(0,0,800,600);
	   ctx.closePath();
	}
	
	function desenhaParede1() {
	    ctx.save();
		ctx.translate(p1x , p1y);
		ctx.fillStyle="brown";
		ctx.beginPath();
	    ctx.fillRect(-50,-50,100,100);
	    ctx.strokeRect(-50,-50,100,100);
  	    ctx.closePath();
		ctx.restore();
		
		ctx.beginPath();
	    ctx.arc(p1x,p1y,5,0,2*Math.PI);
	    ctx.closePath();
	    ctx.fillStyle="blue";
	    ctx.fill();
	    ctx.stroke();
	}
	var anterior = new Date();
	var agora = new Date();
	var dt = agora - anterior;
	console.log (dt);
	function passo(){
		agora = new Date();
		dt = (agora - anterior) / 1000;
		// Movimentação
		p1x-=120*dt;
		pc.mover(dt);
		if (pc.y>250-pc.h/2){
			pc.y=250-pc.h/2;
		}
		//Desenho
		limpaTela();
		desenhaPersonagem();
		desenhaParede1();
		desenhaParede2();
		
		anterior = agora;
	}
	passo();
	window.setInterval(passo,5);
	
</script>
   </body>
</html>
